import{r as t,g as o,j as s}from"./react-ac4fd5c4.js";import{i as M,au as j,T as w,c as G,av as R}from"./index-f4592ea4.js";import{C as T}from"./index-4f4f19d5.js";import{d as U}from"./lodash-44bc1aaf.js";import{I as A}from"./index-6d3b5836.js";import"./vendor-a0dadf07.js";import"./react-router-dom-0434928e.js";import"./react-redux-5a199f59.js";const P=()=>{const a=G("cloud-music"),[h,x]=t.exports.useReducer(B,[]),[,y]=t.exports.useState(0),[c,C]=t.exports.useState(0),[n,S]=t.exports.useState(0),[,g]=t.exports.useState(""),F=t.exports.useMemo(()=>c===0?0:n*100/c,[n,c]);let i=0;const d=30,u=t.exports.useRef(null),I=U(r=>{g(r.currentTarget.value)},500);async function p(){var f;const r=await R(i,d),{data:e,maxSize:l,size:v,count:z,hasMore:N}=r,D=i===0?"reset":"add",E=e.map(b=>b.simpleSong);x({type:D,payload:E}),C(m(l)),S(m(v)),y(z),(f=u.current)==null||f.call(u,N),i+=d}function B(r,e){return e.type==="add"?[...r,...e.payload]:e.payload}function m(r){try{let e=BigInt(r);const l=BigInt(1024);return e*=BigInt(10),e/=l**BigInt(3),Number(e)/10}catch(e){return console.error(e),0}}return t.exports.useEffect(()=>{p()},[]),o("div",{children:[o("header",{className:a("header"),children:[o("div",{className:a("capacity"),children:[s("span",{className:a("capacity-title"),children:"\u4E91\u76D8\u5BB9\u91CF"}),s("div",{className:a("ruler"),children:s("div",{style:{width:`${F}%`}})}),o("span",{className:a("capacity-ratio"),children:[n,"G/",c,"G"]}),s("span",{className:a("capacity-description"),children:"\u6B4C\u66F2\u6C38\u4E45\u4FDD\u5B58\uFF0C\u968F\u65F6\u968F\u5730\u591A\u7AEF\u7545\u542C"})]}),o("div",{className:a("control"),children:[s(M,{compose:!0}),s(j,{placeholder:"\u641C\u7D22\u4E91\u76D8\u97F3\u4E50",onInput:I})]})]}),s(w,{columns:T,data:h}),s(A,{ref:u,cb:p})]})};export{P as default};
