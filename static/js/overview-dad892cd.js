import{u as C,r as o,R as t}from"./react-f2ce6df7.js";import{s as D}from"./index-21e9be10.js";import{b,r as N,T as w,o as j,j as F,D as x,c as A,aC as P,k as T,m as B}from"./index-42c9aaa4.js";import{k as I,J as O,ak as M,n as R}from"./vendor-989d90fd.js";import{u as H,a as U}from"./react-redux-df697b15.js";import"./lodash-753d2698.js";import"./react-router-dom-afba9a75.js";var z="static/png/top50-cb618a89.png";const S=({id:i,title:l="\u70ED\u95E850\u9996",imgUrl:u=z,data:r,isAlbum:E})=>{const v=H(),{push:n}=C(),[m,f]=o.exports.useState(!1),k=[{key:"ordinal"},{key:"name"},{key:"dt",format:j}],h=o.exports.useMemo(()=>m?r:r.slice(0,10),[m,r]),a=U(e=>!!e.user.cookie);function p(e=0){v(F({current:e,tracks:r,fm:[]}))}function g(){!i||(E?n(x.list(i,"album")):a?n(x.list(i)):R.error("\u9700\u8981\u767B\u5F55\uFF0C\u624D\u80FD\u67E5\u770B\u4ED6\u4EBA\u6B4C\u5355\u4FE1\u606F>_<"))}function d(){}return o.exports.useEffect(()=>{r.length<=10&&r.length>0&&f(!0)},[r]),t.createElement("section",{className:c("item")},t.createElement(b,{src:N(u,150),className:I(c("img"),{[D["--top50"]]:l==="\u70ED\u95E850\u9996"}),onClick:g}),t.createElement("div",{className:c("right")},t.createElement("header",{className:c("header")},t.createElement("h2",null,l),t.createElement("div",{className:c("icon")},t.createElement(O,{onClick:()=>p()}),t.createElement(M,{onClick:d}))),t.createElement("div",{className:c("table")},t.createElement(w,{noHead:!0,columns:k,data:h,onDoubleClick:p}),!m&&r.length>0&&t.createElement("footer",{className:c("footer"),onClick:()=>f(!0)},t.createElement("div",null,"\u67E5\u770B\u5168\u90E8",r.length,"\u9996 >")))))},c=A("overview",D),V=({id:i,data:l,isAlbum:u,myself:r})=>{const[E,v]=o.exports.useState([]),n=o.exports.useRef(null),[m,f]=o.exports.useState([]),[k,h]=o.exports.useState("\u52A0\u8F7D\u4E2D...");let a=0;async function p(){const e=await P(i);v(e.songs)}async function g(e){const s=l[e];if(!(s==null?void 0:s.id))return;const y=await T(s.id);s.songs=y.songs}async function d(e){if(!r)return;const s=l[e];if(!(s==null?void 0:s.id))return;const y=await B(s.id);s.songs=y.playlist.tracks}return o.exports.useEffect(()=>{u?(p(),g(a)):d(a)},[i]),o.exports.useEffect(()=>{if(!(n==null?void 0:n.current))return;const e=new IntersectionObserver(s=>{s[0].intersectionRatio<=0||(a++,a<l.length?(u?g(a):d(a),f(l.slice(0,a))):h(""))});return e.observe(n.current),()=>{n.current&&e.unobserve(n.current),e.disconnect()}},[]),t.createElement("div",{className:c()},u&&t.createElement(S,{data:E,isAlbum:!0}),m.map(e=>t.createElement(S,{key:e.id,id:e.id,title:e.name,imgUrl:e.picUrl,data:e.songs,isAlbum:u})),t.createElement("footer",{ref:n,className:c("more")},k))};export{V as default,c as getClass};
