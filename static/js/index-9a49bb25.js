import{u as v,R as e,r as n,n as I}from"./react-6a93a4b0.js";import{c as h,D as x,b as T,r as B,J as D,Q as H,R as q}from"./index-efec1b87.js";import{P as w}from"./index-4abeff12.js";import{au as S,k as g,av as F}from"./vendor-2d6f78b2.js";import{u as O}from"./react-redux-0a51a65b.js";import{I as Q}from"./index-226479be.js";import"./lodash-44bc1aaf.js";import"./react-router-dom-6c750f63.js";function U(a,l){const c=h("excellent"),{push:o}=v(),m=e.createElement(e.Fragment,null,e.createElement(S,null),"\u7B5B\u9009");function i(s){s!==l&&o(x.excellentList(s))}function r(){return e.createElement("div",{className:c("popover")},e.createElement("header",{className:c("popover-header")},e.createElement("span",{className:g({"--active":l==="\u5168\u90E8"}),onClick:()=>i("\u5168\u90E8")},"\u5168\u90E8\u6B4C\u5355")),e.createElement("section",{className:c("popover-card")},a.map(s=>e.createElement("div",{key:s.id},e.createElement("span",{className:g({"--active":s.name===l}),onClick:()=>i(s.name)},s.name)))))}return{buttonContext:m,renderPopover:r}}const W=()=>{const a=h("excellent"),[l,c]=n.exports.useState([]),o=I().id,[m,i]=n.exports.useReducer(b,[]),r=n.exports.useRef(null),{push:s}=v(),C=O(),p=n.exports.useRef(),N=10,{buttonContext:P,renderPopover:k}=U(l,o),f=n.exports.useRef(!0);async function R(){const t=await H();c(t.tags)}async function E(){var u;const t=await q(o,N,p.current),d=p.current===void 0?"reset":"add";i({type:d,payload:t.playlists}),p.current=t.lasttime,t.lasttime||(u=r.current)==null||u.call(r,!1)}function b(t,d){const{type:u,payload:y}=d;return u==="add"?[...t,...y]:y}return n.exports.useEffect(()=>{R()},[]),n.exports.useEffect(()=>{f.current?f.current=!1:E()},[o]),e.createElement("div",{className:a()},e.createElement("header",{className:a("control")},e.createElement("div",{className:a("control-title")},"\u7CBE\u54C1\u6B4C\u5355 ",e.createElement(F,null)),e.createElement(w,{className:a("control-pick"),placement:"right",context:P,functionChildren:k})),e.createElement("div",{className:a("card")},m.map(t=>e.createElement("div",{key:t.id,className:a("item")},e.createElement(T,{className:a("img"),icon:{hoverDisplay:!0,placement:"bottom"},src:B(t.coverImgUrl,150),onClick:()=>s(x.list(t.id)),onIconClick:()=>C(D(t.id))}),e.createElement("div",{className:a("right")},e.createElement("h3",null,t.name),e.createElement("small",null,"by ",t.creator.nickname),e.createElement("div",{className:a("description")},e.createElement("span",null,t.tags.join(","))," ",t.copywriter))))),e.createElement(Q,{ref:r,cb:E}))};export{W as default};
