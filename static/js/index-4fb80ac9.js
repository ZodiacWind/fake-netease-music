import{r,R as e,n as z,u as G}from"./react-d9b453ce.js";import{s as L}from"./collector.module-b0079d28.js";import{b as S,r as k,c as g,d as R,C as q,e as J,f as K,t as Q,h as V,i as b,w as C,D as A,T as X,j as Z,k as ee,l as te,m as ae}from"./index-b04d1018.js";import{u as se,a as le}from"./react-redux-5d8bd3cd.js";import{U as ne,k as me,ai as re,h as T,$ as ce,a2 as ie,D as oe,aj as N}from"./vendor-ff9a3620.js";import{W as ue,s as Ee}from"./write-comment-f5170535.js";import{C as pe}from"./index-c6de5a94.js";import"./lodash-44bc1aaf.js";import"./react-router-dom-11648034.js";const de=({id:a})=>{const l=g("collector",L),[c,d]=r.exports.useState([]),[f,v]=r.exports.useState(0),[y,t]=r.exports.useState(1);async function E(s=1,i=20){const m=(s-1)*i,o=await R({id:a,offset:m,limit:i});d(o.subscribers),v(o.total)}return r.exports.useEffect(()=>{a&&E()},[a]),c.length>0?e.createElement(e.Fragment,null,e.createElement("div",{className:l()},c.map(s=>e.createElement("div",{key:s.userId,className:l("item")},e.createElement(S,{className:l("img"),src:k(s.avatarUrl,100)}),e.createElement("div",null,e.createElement("div",{className:l("title")},s.nickname),s.signature&&e.createElement("div",{className:l("subtitle")},s.signature))))),e.createElement("footer",{className:l("footer")},e.createElement(ne,{current:y,total:f,onChange:(s,i)=>{t(s),E(s,i)},pageSize:100,showSizeChanger:!1}))):e.createElement("div",{className:l("empty")},"\u6682\u65E0\u6536\u85CF\u8005")},be=({id:a,isAlbum:l})=>{const c=g("comments-list",Ee);return e.createElement("div",{className:c()},e.createElement(ue,null),e.createElement(q,{id:a,api:l?J:K}))};var Ce={"album-detail":"_album-detail_1r2oa_1","album-detail__title":"_album-detail__title_1r2oa_4"};const Ne=({description:a})=>{const l=g("album-detail",Ce);return e.createElement("div",{className:l()},e.createElement("header",{className:l("title")},"\u4E13\u8F91\u4ECB\u7ECD"),e.createElement("p",null,a))},Fe=()=>{const a=g("list"),l=z(),[c,d]=r.exports.useState([]),f=se(),[v,y]=r.exports.useState(""),[t,E]=r.exports.useState(),s=r.exports.useMemo(()=>Number(l.id),[l.id]),{push:i}=G(),m=r.exports.useMemo(()=>!!l.type,[l.type]),o=le(n=>n.user.profile);function B(n=0){f(Z({current:n,tracks:c,fm:[]}))}function P(n){i(A.user(n))}async function _(){const[n,D]=await Promise.all([ee(s),te(s)]),p=n.songs.map(u=>{var F;return u.disable=(F=u==null?void 0:u.privilege)!=null&&F.cp?!u.privilege.cp:!1,u});d(p);const{picUrl:h,name:Y,artist:w,publishTime:M,description:j}=n.album,{subCount:W,shareCount:$,commentCount:H}=D,O={coverImgUrl:h,name:Y,subscribedCount:W,shareCount:$,commentCount:H,createTime:M,artistName:w.name};E(O),y(j)}async function x(){const n=await ae(s),D=n.playlist.tracks.map((p,h)=>(p.disable=!n.privileges[h].cp&&!p.pc,p));d(D),E(n.playlist)}function I(){var n;return e.createElement("div",{className:a("description")},e.createElement("div",{className:a("tag")},e.createElement("span",{className:"--title"},"\u6807\u7B7E: "),e.createElement("span",null,(n=t==null?void 0:t.tags)==null?void 0:n.join("/"))),e.createElement("div",{className:a("count")},e.createElement("span",null,e.createElement("span",{className:"--title"},"\u6B4C\u66F2\u6570: "),C(t==null?void 0:t.trackCount)),e.createElement("span",{className:"--left"},e.createElement("span",{className:"--title"},"\u64AD\u653E\u6570: "),C(t==null?void 0:t.playCount))),e.createElement("div",{className:a("introduction")},e.createElement("span",{className:"--title"},"\u7B80\u4ECB: "),e.createElement("div",null,t==null?void 0:t.description)))}function U(){return e.createElement("div",{className:a("description")},e.createElement("div",{className:a("singer")},e.createElement("span",{className:"--title"},"\u6B4C\u624B: "),e.createElement("span",{onClick:()=>i(A.singer(t==null?void 0:t.id))},t==null?void 0:t.artistName)),e.createElement("div",{className:a("publish-time")},e.createElement("span",{className:"--title"},"\u65F6\u95F4: "),e.createElement("span",null,T(t==null?void 0:t.createTime).format("YYYY-MM-DD"))))}return r.exports.useEffect(()=>{Number.isNaN(s)||(m?_():x())},[s,m]),e.createElement("div",{className:a()},e.createElement("header",{className:a("header")},s&&(t==null?void 0:t.coverImgUrl)?e.createElement(S,{className:me("list__img",{"--album":m}),src:k(t.coverImgUrl,300),alt:"avatar"}):e.createElement("div",{className:a("img-default")},e.createElement(re,null)),e.createElement("div",{className:a("right")},e.createElement("div",{className:a("title")},e.createElement("span",null,m?"\u4E13\u8F91":"\u6B4C\u5355"),e.createElement("strong",null,(t==null?void 0:t.name)||"\u6211\u559C\u6B22\u7684\u97F3\u4E50")),!m&&e.createElement("div",{className:a("user-info")},e.createElement("img",{src:Q(k(o.avatarUrl||V,100)),alt:"avatar",onClick:()=>P(o.userId)}),e.createElement("a",{onClick:()=>P(o.userId)},o.nickname),e.createElement("span",null,T(t==null?void 0:t.createTime).format("YYYY-MM-DD"),"\u521B\u5EFA")),e.createElement("div",{className:a("control")},e.createElement(b,{compose:!0,onClick:()=>B()}),e.createElement(b,null,e.createElement(ce,null),"\u6536\u85CF(",C(t==null?void 0:t.subscribedCount),")"),e.createElement(b,null,e.createElement(ie,null),"\u5206\u4EAB(",C((t==null?void 0:t.shareCount)||0),")"),e.createElement(b,null,e.createElement(oe,null),"\u4E0B\u8F7D\u5168\u90E8")),m?U():I())),e.createElement("section",{className:a("tabs")},e.createElement(N,null,e.createElement(N.TabPane,{tab:"\u6B4C\u66F2\u5217\u8868",key:"1"},e.createElement(X,{columns:pe,data:c,onDoubleClick:B})),e.createElement(N.TabPane,{tab:`\u8BC4\u8BBA(${(t==null?void 0:t.commentCount)||0})`,key:"2"},e.createElement(be,{id:s,isAlbum:m})),e.createElement(N.TabPane,{tab:m?"\u4E13\u8F91\u8BE6\u60C5":"\u6536\u85CF\u8005",key:"3"},m?e.createElement(Ne,{description:v}):e.createElement(de,{id:s})))))};export{Fe as default};
