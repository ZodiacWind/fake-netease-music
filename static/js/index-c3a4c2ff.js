import{u as v,R as e,r as n,o as R}from"./react-cb61e8c1.js";import{c as g,D as h,b as I,r as T,J as B,Q as D,R as H}from"./index-7638329a.js";import{P as q}from"./index-1dc1658b.js";import{au as w,k as x,av as S}from"./vendor-b86105ba.js";import{u as F}from"./react-redux-35258e53.js";import{I as O}from"./index-6fa3ffe2.js";import"./lodash-0d4875ad.js";import"./react-router-dom-23ef9bd5.js";function Q(a,c){const l=g("excellent"),{push:o}=v(),m=e.createElement(e.Fragment,null,e.createElement(w,null),"\u7B5B\u9009");function i(s){s!==c&&o(h.excellentList(s))}function r(){return e.createElement("div",{className:l("popover")},e.createElement("header",{className:l("popover-header")},e.createElement("span",{className:x({"--active":c==="\u5168\u90E8"}),onClick:()=>i("\u5168\u90E8")},"\u5168\u90E8\u6B4C\u5355")),e.createElement("section",{className:l("popover-card")},a.map(s=>e.createElement("div",{key:s.id},e.createElement("span",{className:x({"--active":s.name===c}),onClick:()=>i(s.name)},s.name)))))}return{buttonContext:m,renderPopover:r}}const W=()=>{const a=g("excellent"),[c,l]=n.exports.useState([]),o=R().id,[m,i]=n.exports.useReducer(j,[]),r=n.exports.useRef(null),{push:s}=v(),C=F(),p=n.exports.useRef(),N=10,{buttonContext:b,renderPopover:P}=Q(c,o),f=n.exports.useRef(!0);async function k(){const t=await D();l(t.tags)}async function E(){var u;const t=await H(o,N,p.current),d=p.current===void 0?"reset":"add";i({type:d,payload:t.playlists}),p.current=t.lasttime,t.lasttime||(u=r.current)==null||u.call(r,!1)}function j(t,d){const{type:u,payload:y}=d;return u==="add"?[...t,...y]:y}return n.exports.useEffect(()=>{k()},[]),n.exports.useEffect(()=>{f.current?f.current=!1:E()},[o]),e.createElement("div",{className:a()},e.createElement("header",{className:a("control")},e.createElement("div",{className:a("control-title")},"\u7CBE\u54C1\u6B4C\u5355 ",e.createElement(S,null)),e.createElement(q,{className:a("control-pick"),placement:"right",context:b,functionChildren:P})),e.createElement("div",{className:a("card")},m.map(t=>e.createElement("div",{key:t.id,className:a("item")},e.createElement(I,{className:a("img"),icon:{hoverDisplay:!0,placement:"bottom"},src:T(t.coverImgUrl,150),onClick:()=>s(h.list(t.id)),onIconClick:()=>C(B(t.id))}),e.createElement("div",{className:a("right")},e.createElement("h3",null,t.name),e.createElement("small",null,"by ",t.creator.nickname),e.createElement("div",{className:a("description")},e.createElement("span",null,t.tags.join(","))," ",t.copywriter))))),e.createElement(O,{ref:r,cb:E}))};export{W as default};
