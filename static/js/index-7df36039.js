var Q=Object.defineProperty,W=Object.defineProperties;var X=Object.getOwnPropertyDescriptors;var x=Object.getOwnPropertySymbols;var P=Object.prototype.hasOwnProperty,M=Object.prototype.propertyIsEnumerable;var L=(s,t,e)=>t in s?Q(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e,E=(s,t)=>{for(var e in t||(t={}))P.call(t,e)&&L(s,e,t[e]);if(x)for(var e of x(t))M.call(t,e)&&L(s,e,t[e]);return s},k=(s,t)=>W(s,X(t));var j=(s,t)=>{var e={};for(var a in s)P.call(s,a)&&t.indexOf(a)<0&&(e[a]=s[a]);if(s!=null&&x)for(var a of x(s))t.indexOf(a)<0&&M.call(s,a)&&(e[a]=s[a]);return e};import{r as C,g as h,j as i,F as G,u as S,h as Z}from"./react-7f918845.js";import{U as tt,ad as et,h as st,k as nt,aa as rt,aj as O}from"./vendor-2e679db4.js";import{u as at,S as p,T as V,v as ot,c as R,o as q,b as Y,r as z,x as w,D as U,y as ct,z as it}from"./index-b2307066.js";import{L as I}from"./index-7ffab79e.js";import{u as ut}from"./react-redux-8df6583b.js";import"./lodash-44bc1aaf.js";import"./react-router-dom-102d9908.js";const lt="_song_e7i4c_1",mt="_song__header_e7i4c_4",dt="_song__title_e7i4c_7",pt="_song__wrapper_e7i4c_13",_t="_song__left_e7i4c_33",gt="_song__img_e7i4c_38",ht="_song__footer_e7i4c_45",yt="_song__subtitle_e7i4c_50";var ft={song:lt,song__header:mt,song__title:dt,song__wrapper:pt,"song__best-match":"_song__best-match_e7i4c_18",song__left:_t,song__img:gt,song__footer:ht,song__subtitle:yt};const N=({limit:s=20,type:t,keywords:e,currentType:a,setTotal:c})=>{const[n,r]=C.exports.useState(),[u,l]=C.exports.useState(1),m=C.exports.useMemo(()=>d(n),[t,n]);async function _(b=1,f=20){const A=(b-1)*f,g=await at({type:t,keywords:e,offset:A,limit:s});c(d(g.result)),r(g.result)}function o(b,f){l(b),_(b,f)}function d(b){return b&&b[{1:"songCount",100:"artistCount",10:"albumCount",1014:"videoCount",1e3:"playlistCount",1006:"songCount",1009:"djRadiosCount",1002:"userprofileCount"}[t]]||0}function F(b){const f=h("div",{className:$("empty"),children:["\u5F88\u62B1\u6B49\uFF0C\u672A\u80FD\u627E\u5230\u4E0E\u201C",i("span",{children:e}),"\u201D\u76F8\u5173\u7684\u4EFB\u4F55\u4FE1\u606F\u3002"]});return n?h(G,{children:[b(n),m>s&&i("footer",{className:$("footer"),children:i(tt,{total:m,showSizeChanger:!1,current:u,onChange:o})})]}):f}return C.exports.useEffect(()=>{t===a&&_()},[t,e]),{wrapEmpty:F}},bt=s=>{const t=R("song",ft),_=s,{bestMatch:e}=_,a=j(_,["bestMatch"]),c=k(E({},a),{currentType:p.SONG,limit:100}),{wrapEmpty:n}=N(c),{push:r}=S(),u=ut(),l=[{title:"",key:"ordinal"},{title:"",key:"action"},{title:"\u97F3\u4E50\u6807\u9898",key:"name"},{title:"\u6B4C\u624B",render(o){return o.artists.map(d=>i("span",{children:d.name},d.id))}},{title:"\u4E13\u8F91",key:"album.name"},{title:"\u65F6\u957F",key:"duration",format:q}];function m(o,d){if(!e)return;const f=({album:()=>{const{id:g,name:y,picUrl:v,artist:D}=e[o][0],B=D.name;return{id:g,name:y,imgUrl:v,subtitle:B}},artist:()=>{const{id:g,name:y,picUrl:v}=e[o][0];return{id:g,name:y,imgUrl:v}},playlist:()=>{const{id:g,name:y,coverImgUrl:v}=e[o][0];return{id:g,name:y,imgUrl:v}},song:()=>{const{id:g,name:y,album:v}=e[o],D=v.picUrl;return{id:g,name:y,imgUrl:D}},concert:()=>{const{id:g,cover:y,title:v,time:D}=e[o][0],B=D.reduce((J,K)=>`${J}-${st(K).format("M\u6708D\u65E5")}`,"").slice(1);return{id:g,name:v,imgUrl:y,subtitle:B}}}[o]||w)();function A(g,y){({album:()=>r(U.list(y,"album")),artist:()=>r(U.singer(y)),playlist:()=>r(U.list(y)),song:w,concert:w,orpheus:w})[g]()}return f?h("div",{className:t("best-match"),onClick:()=>A(o,f.id),children:[h("div",{className:t("left"),children:[i(Y,{src:z(f.imgUrl,100),className:t("img")}),h("div",{children:[i("div",{children:f.name}),i("div",{className:t("subtitle"),children:f.subtitle})]})]}),i(et,{})]},d):null}return n(o=>h("div",{className:t(),children:[(e==null?void 0:e.orders)&&h("header",{className:t("header"),children:[i("div",{className:t("title"),children:"\u6700\u4F73\u5339\u914D"}),i("div",{className:t("wrapper"),children:e.orders.filter(d=>d!=="orpheus").map(m)})]}),i(V,{columns:l,data:o.songs,onDoubleClick:d=>u(ot(o.songs[d].id))})]}))},vt=s=>{const t=k(E({},s),{currentType:p.SINGER}),{wrapEmpty:e}=N(t),{push:a}=S();function c(n){return n.map(r=>{const{picUrl:u,name:l,id:m}=r;return{id:m,imgUrl:u,name:l}})}return e(n=>i(I,{data:c(n.artists),onItemClick:({id:r})=>a(U.singer(r))}))},Ct=s=>{const t=k(E({},s),{currentType:p.ALBUM}),{wrapEmpty:e}=N(t),{push:a}=S();function c(n){return n.map(r=>{const{picUrl:u,name:l,artist:m,id:_}=r,{name:o,alias:d}=m,F=`${o}\uFF08${d.join(",")}\uFF09`;return{id:_,imgUrl:u,name:l,col2:F}})}return e(n=>i(I,{imgType:"extra",data:c(n.albums),onItemClick:({id:r})=>a(U.list(r,"album"))}))},Et="_video_wgdnq_1",kt="_video__img_wgdnq_7",Ft="_video__description_wgdnq_12";var H={video:Et,video__img:kt,video__description:Ft,"--mv":"_--mv_wgdnq_31"};const T=R("video",H),Ut=s=>{const t=k(E({},s),{currentType:p.VIDEO,limit:21}),{wrapEmpty:e}=N(t),{push:a}=S();function c(n){a(U.playVideo(n))}return e(n=>i("div",{className:T(),children:n.videos.map(r=>h("div",{className:T("item"),onClick:()=>c(r.vid),children:[i(Y,{src:z(r.coverUrl,460,260),className:T("img")}),h("div",{className:T("description"),children:[i("h2",{className:nt({[H["--mv"]]:r.type===0}),children:r.title}),h("h3",{children:["by ",r.creator.reduce((u,l)=>`${u},${l.userName}`,"").slice(1)]})]})]},r.vid))}))},Nt=s=>{const t=k(E({},s),{currentType:p.PLAYLIST}),{wrapEmpty:e}=N(t),{push:a}=S();function c(n){return n.map(r=>{const{coverImgUrl:u,name:l,trackCount:m,creator:_,id:o}=r,d=`${m}\u9996`,F=`by ${_.nickname}`;return{id:o,imgUrl:u,name:l,col2:d,col3:F}})}return e(n=>i(I,{data:c(n.playlists),onItemClick:({id:r})=>a(U.list(r))}))},St="_lyric_1o214_1";var Dt={lyric:St};const It=s=>{const t=k(E({},s),{currentType:p.LYRIC}),{wrapEmpty:e}=N(t),a=[{title:"",key:"ordinal"},{title:"",key:"action"},{title:"\u97F3\u4E50\u6807\u9898",key:"name",render(c){return h(G,{children:[i("div",{children:c.name}),i(ct,{className:Dt.lyric,children:c.lyrics.txt})]})}},{title:"\u6B4C\u624B",render(c){return c.artists.map(n=>i("span",{children:n.name},n.id))}},{title:"\u4E13\u8F91",key:"album.name"},{title:"\u65F6\u957F",key:"duration",format:q}];return e(c=>i(V,{columns:a,data:c.songs}))},xt=s=>{const t=k(E({},s),{currentType:p.RADIO}),{wrapEmpty:e}=N(t);function a(c){return c.map(n=>{const{picUrl:r,name:u,dj:l,id:m}=n,_=`by ${l.nickname}`;return{id:m,imgUrl:r,name:u,col3:_}})}return e(c=>i(I,{data:a(c.djRadios)}))},wt=s=>{const t=k(E({},s),{currentType:p.USER,limit:20}),{wrapEmpty:e}=N(t),{push:a}=S();function c(n){return n.map(r=>{const{avatarUrl:u,nickname:l,description:m,userId:_}=r;return{id:_,imgUrl:u,name:l,col3:m}})}return e(n=>i(I,{imgType:"circle",data:c(n.userprofiles),onItemClick:({id:r})=>a(U.user(r))}))},$=R("search-result"),jt=()=>{const[s,t]=C.exports.useState(0),[e,a]=C.exports.useState(0),[c,n]=C.exports.useState(),{search:r}=Z(),u=C.exports.useMemo(()=>rt.parse(r.slice(1),{charset:"utf-8"}).keywords,[r]),l=[{type:p.SONG,key:"song",unit:"\u9996",tab:"\u5355\u66F2",component:bt},{type:p.SINGER,key:"singer",unit:"\u4F4D",tab:"\u6B4C\u624B",component:vt},{type:p.ALBUM,key:"album",unit:"\u5F20",tab:"\u4E13\u8F91",component:Ct},{type:p.VIDEO,key:"video",unit:"\u4E2A",tab:"\u89C6\u9891",component:Ut},{type:p.PLAYLIST,key:"playlist",unit:"\u4E2A",tab:"\u6B4C\u5355",component:Nt},{type:p.LYRIC,key:"lyric",unit:"\u9996",tab:"\u6B4C\u8BCD",component:It},{type:p.RADIO,key:"radio",unit:"\u4E2A",tab:"\u4E3B\u64AD\u7535\u53F0",component:xt},{type:p.USER,key:"user",unit:"\u4E2A",tab:"\u7528\u6237",component:wt}],m=C.exports.useMemo(()=>l[e],[e]);function _(o){const d=l.findIndex(F=>F.key===o);d>-1&&a(d)}return C.exports.useEffect(()=>{(async()=>{const o=await it(u);n(o.result)})()},[u]),h("div",{className:"search-result",children:[h("header",{className:$("header"),children:[h("strong",{children:[u," "]}),`\u627E\u5230${s}${m.unit}${m.tab==="\u4E3B\u64AD\u7535\u53F0"?"\u7535\u53F0":m.tab}`]}),i(O,{onChange:_,children:l.map(o=>i(O.TabPane,{tab:o.tab,children:i(o.component,{type:m.type,keywords:u,setTotal:t,bestMatch:o.key==="song"?c:void 0})},o.key))})]})};export{jt as default,$ as getClass};
