import{u as x,r as c,R as t}from"./react-d9b453ce.js";import{s as C}from"./index-c701e4e4.js";import{b as N,r as b,T as w,o as F,j as A,D as y,c as P,aD as T,k as B,m as I}from"./index-1e77e576.js";import{k as O,J as M,ak as R,n as H}from"./vendor-ff9a3620.js";import{u as U,a as j}from"./react-redux-5d8bd3cd.js";import"./lodash-44bc1aaf.js";import"./react-router-dom-11648034.js";var z="static/png/top50-cb618a89.png";const S=({id:i,title:l="\u70ED\u95E850\u9996",imgUrl:u=z,data:n,isAlbum:d})=>{const k=U(),{push:r}=x(),[m,f]=c.exports.useState(!1),v=[{key:"ordinal"},{key:"name"},{key:"dt",format:F}],D=c.exports.useMemo(()=>m?n:n.slice(0,10),[m,n]),o=j(e=>!!e.user.cookie);function p(e=0){k(A({current:e,tracks:n,fm:[]}))}function g(){!i||(d?r(y.list(i,"album")):o?r(y.list(i)):H.error("\u9700\u8981\u767B\u5F55\uFF0C\u624D\u80FD\u67E5\u770B\u4ED6\u4EBA\u6B4C\u5355\u4FE1\u606F>_<"))}function E(){}return c.exports.useEffect(()=>{n.length<=10&&n.length>0&&f(!0)},[n]),t.createElement("section",{className:a("item")},t.createElement(N,{src:b(u,150),className:O(a("img"),{[C["--top50"]]:l==="\u70ED\u95E850\u9996"}),onClick:g}),t.createElement("div",{className:a("right")},t.createElement("header",{className:a("header")},t.createElement("h2",null,l),t.createElement("div",{className:a("icon")},t.createElement(M,{onClick:()=>p()}),t.createElement(R,{onClick:E}))),t.createElement("div",{className:a("table")},t.createElement(w,{noHead:!0,columns:v,data:D,onDoubleClick:p}),!m&&n.length>0&&t.createElement("footer",{className:a("footer"),onClick:()=>f(!0)},t.createElement("div",null,"\u67E5\u770B\u5168\u90E8",n.length,"\u9996 >")))))},a=P("overview",C),V=({id:i,data:l,isAlbum:u,myself:n})=>{const[d,k]=c.exports.useState([]),r=c.exports.useRef(null),[m,f]=c.exports.useState([]),[v,D]=c.exports.useState("\u52A0\u8F7D\u4E2D...");let o=0;async function p(){const e=await T(i);k(e.songs)}async function g(e){const s=l[e];if(!(s!=null&&s.id))return;const h=await B(s.id);s.songs=h.songs}async function E(e){if(!n)return;const s=l[e];if(!(s!=null&&s.id))return;const h=await I(s.id);s.songs=h.playlist.tracks}return c.exports.useEffect(()=>{u?(p(),g(o)):E(o)},[i]),c.exports.useEffect(()=>{if(!(r!=null&&r.current))return;const e=new IntersectionObserver(s=>{s[0].intersectionRatio<=0||(o++,o<l.length?(u?g(o):E(o),f(l.slice(0,o))):D(""))});return e.observe(r.current),()=>{r.current&&e.unobserve(r.current),e.disconnect()}},[]),t.createElement("div",{className:a()},u&&t.createElement(S,{data:d,isAlbum:!0}),m.map(e=>t.createElement(S,{key:e.id,id:e.id,title:e.name,imgUrl:e.picUrl,data:e.songs,isAlbum:u})),t.createElement("footer",{ref:r,className:a("more")},v))};export{V as default,a as getClass};
