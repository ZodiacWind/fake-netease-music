import{r,R as e,n as F,u as I}from"./react-6ccb7aeb.js";import{t as Y,I as $,c as M,b as U,r as z,w as i,i as h,C as H,Z as L,$ as W,D as V,a0 as j,a1 as K,a2 as Z,a3 as q,a4 as J,a5 as Q}from"./index-0da72bec.js";import{ac as X,z as ee,K as te,$ as ae,a2 as se,h as le}from"./vendor-d86b2c9c.js";import{W as ne}from"./write-comment-25e4066e.js";import"./lodash-44bc1aaf.js";import"./react-router-dom-a13c9756.js";import"./react-redux-b7a88ea1.js";const re="_video_1pcl7_1",oe="_video__control_1pcl7_14",ce="_video__pause_1pcl7_29";var ue={video:re,video__control:oe,video__pause:ce};const ie=({src:a})=>{const m=M("video",ue),[l,t]=r.exports.useState(!1),o=r.exports.useRef(null);return e.createElement("div",{className:m()},e.createElement("video",{ref:o,src:Y(a),autoPlay:!0,controls:!0,onPause:()=>t(!0),onPlay:()=>t(!1)}),l&&e.createElement($,{type:"play",size:"giant",className:m("pause"),onClick:()=>{var u;return(u=o.current)==null?void 0:u.play()}}))},fe=()=>{const a=M("play-video"),l=F().id,[t,o]=r.exports.useState(),[u,D]=r.exports.useState(""),[P,w]=r.exports.useState([]),{goBack:x}=I(),k=r.exports.useMemo(()=>!Number.isNaN(Number(l)),[l]),{push:d}=I();async function T(){const s=await j(l),{creator:n,title:c,publishTime:p,playTime:E,videoGroup:v,praisedCount:C,subscribeCount:N,shareCount:f,commentCount:y}=s.data,g=le(p).format("YYYY-MM-DD"),{avatarUrl:b,nickname:_,userId:B}=n;o({title:c,publishTime:g,playTime:E,videoGroup:v,praisedCount:C,subscribeCount:N,shareCount:f,commentCount:y,avatarUrl:b,nickname:_,userId:B})}async function R(){const[s,n]=await Promise.all([K(Number(l)),Z(Number(l))]),{name:c,publishTime:p,playCount:E,videoGroup:v,subCount:C,shareCount:N,commentCount:f,artistName:y,cover:g,artistId:b}=s.data,{likedCount:_}=n;o({title:c,publishTime:p,playTime:E,videoGroup:v,subscribeCount:C,shareCount:N,commentCount:f,praisedCount:_,nickname:y,avatarUrl:g,artistId:b})}async function O(){var n;const s=await q(l);D((n=s.urls)==null?void 0:n[0].url)}async function S(){const s=await J(Number(l));D(s.data.url)}async function G(){const s=await Q(l);w(s.data)}function A(){t!=null&&t.artistId?d(V.singer(t.artistId)):t!=null&&t.userId&&d(V.user(t.userId))}return r.exports.useEffect(()=>{k?(R(),S()):(T(),O()),G()},[l]),e.createElement("div",{className:a()},e.createElement("div",{className:a("detail")},e.createElement("div",{className:a("left")},e.createElement("h2",{className:a("title")},e.createElement("span",{onClick:()=>x()},e.createElement(X,null)," \u89C6\u9891\u8BE6\u60C5")),e.createElement(ie,{src:u}),e.createElement("div",{className:a("author-wrapper")},t&&e.createElement("div",{className:a("author")},e.createElement(U,{className:a("avatar"),src:z(t.avatarUrl,50),onClick:A}),e.createElement("strong",{onClick:A},t.nickname)),e.createElement("button",{className:a("follow")},e.createElement(ee,null)," \u5173\u6CE8")),e.createElement("h2",{className:a("name")},t==null?void 0:t.title),e.createElement("div",{className:a("publish")},e.createElement("span",null,"\u53D1\u5E03: ",t==null?void 0:t.publishTime),e.createElement("span",null,"\u64AD\u653E: ",i(t==null?void 0:t.playTime),"\u6B21")),e.createElement("div",{className:a("tags")},t==null?void 0:t.videoGroup.map(s=>e.createElement("div",{key:s.id,className:a("tag")},s.name))),e.createElement("div",{className:a("button-group")},e.createElement("div",null,e.createElement(h,null,e.createElement(te,null),"\u8D5E",i(t==null?void 0:t.praisedCount)),e.createElement(h,null,e.createElement(ae,null),"\u6536\u85CF",i(t==null?void 0:t.subscribeCount)),e.createElement(h,null,e.createElement(se,null),"\u5206\u4EAB",i(t==null?void 0:t.shareCount))),e.createElement("a",null,"\u4E3E\u62A5")),e.createElement("h3",{className:a("comment")},"\u542C\u53CB\u8BC4\u8BBA ",e.createElement("span",null,"(\u5DF2\u6709",t==null?void 0:t.commentCount,"\u8BC4\u8BBA)")),e.createElement(ne,null),e.createElement(H,{id:l,api:k?L:W})),e.createElement("div",{className:a("right")},e.createElement("h2",{className:a("title")},"\u76F8\u5173\u63A8\u8350"),P.map(s=>e.createElement("div",{key:s.vid,className:a("item")},e.createElement(U,{className:a("item-img"),src:s.coverUrl,onClick:()=>d(V.playVideo(s.vid))}),e.createElement("div",{className:a("item-description")},e.createElement("div",{className:a("item-title")},s.title),e.createElement("div",{className:a("item-author")},"by ",s.creator.reduce((n,c)=>`${n}/${c.userName}`,"").slice(1))))))))};export{fe as default};
