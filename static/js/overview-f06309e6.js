import{u as N,r as i,g as l,j as a}from"./react-ac4fd5c4.js";import{s as C}from"./index-ad67dc74.js";import{b,r as w,T as F,o as A,j as P,D as S,c as T,aD as B,k as I,m as O}from"./index-f4592ea4.js";import{k as j,J as M,ak as H,n as U}from"./vendor-a0dadf07.js";import{u as z,a as G}from"./react-redux-5a199f59.js";import"./lodash-44bc1aaf.js";import"./react-router-dom-0434928e.js";var J="static/png/top50-cb618a89.png";const x=({id:u,title:c="\u70ED\u95E850\u9996",imgUrl:m=J,data:t,isAlbum:v})=>{const k=z(),{push:o}=N(),[f,p]=i.exports.useState(!1),D=[{key:"ordinal"},{key:"name"},{key:"dt",format:A}],y=i.exports.useMemo(()=>f?t:t.slice(0,10),[f,t]),r=G(e=>!!e.user.cookie);function g(e=0){k(P({current:e,tracks:t,fm:[]}))}function d(){!u||(v?o(S.list(u,"album")):r?o(S.list(u)):U.error("\u9700\u8981\u767B\u5F55\uFF0C\u624D\u80FD\u67E5\u770B\u4ED6\u4EBA\u6B4C\u5355\u4FE1\u606F>_<"))}function h(){}return i.exports.useEffect(()=>{t.length<=10&&t.length>0&&p(!0)},[t]),l("section",{className:n("item"),children:[a(b,{src:w(m,150),className:j(n("img"),{[C["--top50"]]:c==="\u70ED\u95E850\u9996"}),onClick:d}),l("div",{className:n("right"),children:[l("header",{className:n("header"),children:[a("h2",{children:c}),l("div",{className:n("icon"),children:[a(M,{onClick:()=>g()}),a(H,{onClick:h})]})]}),l("div",{className:n("table"),children:[a(F,{noHead:!0,columns:D,data:y,onDoubleClick:g}),!f&&t.length>0&&a("footer",{className:n("footer"),onClick:()=>p(!0),children:l("div",{children:["\u67E5\u770B\u5168\u90E8",t.length,"\u9996 >"]})})]})]})]})},n=T("overview",C),W=({id:u,data:c,isAlbum:m,myself:t})=>{const[v,k]=i.exports.useState([]),o=i.exports.useRef(null),[f,p]=i.exports.useState([]),[D,y]=i.exports.useState("\u52A0\u8F7D\u4E2D...");let r=0;async function g(){const e=await B(u);k(e.songs)}async function d(e){const s=c[e];if(!(s!=null&&s.id))return;const E=await I(s.id);s.songs=E.songs}async function h(e){if(!t)return;const s=c[e];if(!(s!=null&&s.id))return;const E=await O(s.id);s.songs=E.playlist.tracks}return i.exports.useEffect(()=>{m?(g(),d(r)):h(r)},[u]),i.exports.useEffect(()=>{if(!(o!=null&&o.current))return;const e=new IntersectionObserver(s=>{s[0].intersectionRatio<=0||(r++,r<c.length?(m?d(r):h(r),p(c.slice(0,r))):y(""))});return e.observe(o.current),()=>{o.current&&e.unobserve(o.current),e.disconnect()}},[]),l("div",{className:n(),children:[m&&a(x,{data:v,isAlbum:!0}),f.map(e=>a(x,{id:e.id,title:e.name,imgUrl:e.picUrl,data:e.songs,isAlbum:m},e.id)),a("footer",{ref:o,className:n("more"),children:D})]})};export{W as default,n as getClass};
