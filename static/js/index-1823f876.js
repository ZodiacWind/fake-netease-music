import{r,R as e,l as Y,u as I}from"./react-8de69987.js";import{I as F,c as M,b as U,r as $,w as i,i as h,C as z,Y as L,Z as W,D as V,$ as j,a0 as H,a1 as K,a2 as Z,a3 as q,a4 as J}from"./index-4de405b4.js";import{ac as Q,z as X,K as ee,$ as te,a2 as ae,h as se}from"./vendor-a5ef6589.js";import{W as le}from"./write-comment-74082c18.js";import"./lodash-70433db2.js";import"./react-router-dom-0278a61d.js";import"./react-redux-3330aec9.js";const ne="_video_1pcl7_1",re="_video__control_1pcl7_14",oe="_video__pause_1pcl7_29";var ce={video:ne,video__control:re,video__pause:oe};const ue=({src:a})=>{const m=M("video",ce),[l,t]=r.exports.useState(!1),o=r.exports.useRef(null);return e.createElement("div",{className:m()},e.createElement("video",{ref:o,src:a,autoPlay:!0,controls:!0,onPause:()=>t(!0),onPlay:()=>t(!1)}),l&&e.createElement(F,{type:"play",size:"giant",className:m("pause"),onClick:()=>{var u;return(u=o.current)==null?void 0:u.play()}}))},Ne=()=>{const a=M("play-video"),l=Y().id,[t,o]=r.exports.useState(),[u,D]=r.exports.useState(""),[P,w]=r.exports.useState([]),{goBack:x}=I(),k=r.exports.useMemo(()=>!Number.isNaN(Number(l)),[l]),{push:d}=I();async function T(){const s=await j(l),{creator:n,title:c,publishTime:p,playTime:E,videoGroup:v,praisedCount:C,subscribeCount:N,shareCount:f,commentCount:y}=s.data,g=se(p).format("YYYY-MM-DD"),{avatarUrl:b,nickname:_,userId:B}=n;o({title:c,publishTime:g,playTime:E,videoGroup:v,praisedCount:C,subscribeCount:N,shareCount:f,commentCount:y,avatarUrl:b,nickname:_,userId:B})}async function R(){const[s,n]=await Promise.all([H(Number(l)),K(Number(l))]),{name:c,publishTime:p,playCount:E,videoGroup:v,subCount:C,shareCount:N,commentCount:f,artistName:y,cover:g,artistId:b}=s.data,{likedCount:_}=n;o({title:c,publishTime:p,playTime:E,videoGroup:v,subscribeCount:C,shareCount:N,commentCount:f,praisedCount:_,nickname:y,avatarUrl:g,artistId:b})}async function O(){var n;const s=await Z(l);D((n=s.urls)==null?void 0:n[0].url)}async function S(){const s=await q(Number(l));D(s.data.url)}async function G(){const s=await J(l);w(s.data)}function A(){t!=null&&t.artistId?d(V.singer(t.artistId)):t!=null&&t.userId&&d(V.user(t.userId))}return r.exports.useEffect(()=>{k?(R(),S()):(T(),O()),G()},[l]),e.createElement("div",{className:a()},e.createElement("div",{className:a("detail")},e.createElement("div",{className:a("left")},e.createElement("h2",{className:a("title")},e.createElement("span",{onClick:()=>x()},e.createElement(Q,null)," \u89C6\u9891\u8BE6\u60C5")),e.createElement(ue,{src:u}),e.createElement("div",{className:a("author-wrapper")},t&&e.createElement("div",{className:a("author")},e.createElement(U,{className:a("avatar"),src:$(t.avatarUrl,50),onClick:A}),e.createElement("strong",{onClick:A},t.nickname)),e.createElement("button",{className:a("follow")},e.createElement(X,null)," \u5173\u6CE8")),e.createElement("h2",{className:a("name")},t==null?void 0:t.title),e.createElement("div",{className:a("publish")},e.createElement("span",null,"\u53D1\u5E03: ",t==null?void 0:t.publishTime),e.createElement("span",null,"\u64AD\u653E: ",i(t==null?void 0:t.playTime),"\u6B21")),e.createElement("div",{className:a("tags")},t==null?void 0:t.videoGroup.map(s=>e.createElement("div",{key:s.id,className:a("tag")},s.name))),e.createElement("div",{className:a("button-group")},e.createElement("div",null,e.createElement(h,null,e.createElement(ee,null),"\u8D5E",i(t==null?void 0:t.praisedCount)),e.createElement(h,null,e.createElement(te,null),"\u6536\u85CF",i(t==null?void 0:t.subscribeCount)),e.createElement(h,null,e.createElement(ae,null),"\u5206\u4EAB",i(t==null?void 0:t.shareCount))),e.createElement("a",null,"\u4E3E\u62A5")),e.createElement("h3",{className:a("comment")},"\u542C\u53CB\u8BC4\u8BBA ",e.createElement("span",null,"(\u5DF2\u6709",t==null?void 0:t.commentCount,"\u8BC4\u8BBA)")),e.createElement(le,null),e.createElement(z,{id:l,api:k?L:W})),e.createElement("div",{className:a("right")},e.createElement("h2",{className:a("title")},"\u76F8\u5173\u63A8\u8350"),P.map(s=>e.createElement("div",{key:s.vid,className:a("item")},e.createElement(U,{className:a("item-img"),src:s.coverUrl,onClick:()=>d(V.playVideo(s.vid))}),e.createElement("div",{className:a("item-description")},e.createElement("div",{className:a("item-title")},s.title),e.createElement("div",{className:a("item-author")},"by ",s.creator.reduce((n,c)=>`${n}/${c.userName}`,"").slice(1))))))))};export{Ne as default};
