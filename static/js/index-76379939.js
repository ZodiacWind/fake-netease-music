import{u as x,g as r,F as T,j as s,r as n,p as B}from"./react-7f918845.js";import{c as C,D as N,b as D,r as H,K as j,R as q,U as w}from"./index-b2307066.js";import{P as F}from"./index-f819dae0.js";import{au as S,k as v,av as U}from"./vendor-2e679db4.js";import{u as O}from"./react-redux-8df6583b.js";import{I as z}from"./index-6dc6c590.js";import"./lodash-44bc1aaf.js";import"./react-router-dom-102d9908.js";function A(a,l){const o=C("excellent"),{push:i}=x(),p=r(T,{children:[s(S,{}),"\u7B5B\u9009"]});function u(t){t!==l&&i(N.excellentList(t))}function c(){return r("div",{className:o("popover"),children:[s("header",{className:o("popover-header"),children:s("span",{className:v({"--active":l==="\u5168\u90E8"}),onClick:()=>u("\u5168\u90E8"),children:"\u5168\u90E8\u6B4C\u5355"})}),s("section",{className:o("popover-card"),children:a.map(t=>s("div",{children:s("span",{className:v({"--active":t.name===l}),onClick:()=>u(t.name),children:t.name})},t.id))})]})}return{buttonContext:p,renderPopover:c}}const Y=()=>{const a=C("excellent"),[l,o]=n.exports.useState([]),i=B().id,[p,u]=n.exports.useReducer(R,[]),c=n.exports.useRef(null),{push:t}=x(),P=O(),m=n.exports.useRef(),k=10,{buttonContext:b,renderPopover:E}=A(l,i),f=n.exports.useRef(!0);async function I(){const e=await q();o(e.tags)}async function y(){var d;const e=await w(i,k,m.current),h=m.current===void 0?"reset":"add";u({type:h,payload:e.playlists}),m.current=e.lasttime,e.lasttime||(d=c.current)==null||d.call(c,!1)}function R(e,h){const{type:d,payload:g}=h;return d==="add"?[...e,...g]:g}return n.exports.useEffect(()=>{I()},[]),n.exports.useEffect(()=>{f.current?f.current=!1:y()},[i]),r("div",{className:a(),children:[r("header",{className:a("control"),children:[r("div",{className:a("control-title"),children:["\u7CBE\u54C1\u6B4C\u5355 ",s(U,{})]}),s(F,{className:a("control-pick"),placement:"right",context:b,functionChildren:E})]}),s("div",{className:a("card"),children:p.map(e=>r("div",{className:a("item"),children:[s(D,{className:a("img"),icon:{hoverDisplay:!0,placement:"bottom"},src:H(e.coverImgUrl,150),onClick:()=>t(N.list(e.id)),onIconClick:()=>P(j(e.id))}),r("div",{className:a("right"),children:[s("h3",{children:e.name}),r("small",{children:["by ",e.creator.nickname]}),r("div",{className:a("description"),children:[s("span",{children:e.tags.join(",")})," ",e.copywriter]})]})]},e.id))}),s(z,{ref:c,cb:y})]})};export{Y as default};
